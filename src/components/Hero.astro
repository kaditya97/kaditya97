---
// EarthSatelliteHero.astro
// Hero section with 3D Earth & Satellite visualization
---

<section id="hero-section">
    <div id="earth-satellite-container"></div>

    <div class="hero-content">
        <div class="space-y-8">
            <div
                class="inline-flex items-center px-4 py-2 bg-cyan-500/10 border border-cyan-500/30 rounded-full"
            >
                <span
                    class="w-2 h-2 bg-cyan-400 rounded-full mr-2 animate-pulse"
                ></span>
                <span class="text-cyan-400 text-sm">Available for Projects</span
                >
            </div>

            <h1 class="text-5xl lg:text-7xl font-bold leading-tight">
                <span class="text-white">Geomatics</span><br />
                <span class="gradient-text">Engineer</span><br />
                <span class="text-slate-400 text-4xl lg:text-5xl"
                    >& Senior Software Developer</span
                >
            </h1>

            <p class="text-xl text-slate-400 max-w-xl">
                Bridging the gap between <span class="text-cyan-400"
                    >Geographic Information Systems</span
                >,
                <span class="text-emerald-400">Remote Sensing</span>, and
                <span class="text-blue-400">Modern Software Development</span> to
                build innovative spatial solutions.
            </p>

            <div class="flex flex-wrap gap-4">
                <a
                    href="#projects"
                    class="px-8 py-4 bg-gradient-to-r from-cyan-500 to-emerald-500 rounded-lg font-semibold hover:opacity-90 transition transform hover:scale-105"
                >
                    View My Work
                </a>
                <a
                    href="#contact"
                    class="px-8 py-4 border border-slate-600 rounded-lg font-semibold hover:border-cyan-500 hover:text-cyan-400 transition"
                >
                    Get In Touch
                </a>
            </div>

            <div class="flex items-center space-x-6 pt-4">
                <a
                    href="https://www.github.com/kaditya97"
                    class="text-slate-400 hover:text-cyan-400 text-2xl transition"
                    ><i class="fab fa-github"></i></a
                >
                <a
                    href="https://www.linkedin.com/in/kaditya97/"
                    class="text-slate-400 hover:text-cyan-400 text-2xl transition"
                    ><i class="fab fa-linkedin"></i></a
                >
                <a
                    href="https://twitter.com/kaditya97"
                    class="text-slate-400 hover:text-cyan-400 text-2xl transition"
                    ><i class="fab fa-twitter"></i></a
                >
                <a
                    href="mailto:aditya.kushwaha@opengeohub.org"
                    class="text-slate-400 hover:text-cyan-400 text-2xl transition"
                    ><i class="fas fa-envelope"></i></a
                >
            </div>
        </div>
    </div>
    <div
        class="absolute bottom-10 left-1/2 transform -translate-x-1/2 animate-bounce"
    >
        <i class="fas fa-chevron-down text-cyan-400 text-2xl"></i>
    </div>
</section>

<style>
    #hero-section {
        position: relative;
        width: 100%;
        height: 100vh;
        margin: 0;
        overflow: hidden;
        background-color: #000;
        display: flex;
        align-items: center;
    }

    #earth-satellite-container {
        position: absolute;
        top: 0;
        right: 0;
        width: 50%;
        height: 100%;
        z-index: 1;
    }

    #earth-satellite-container canvas {
        display: block;
    }

    .hero-content {
        position: relative;
        z-index: 10;
        width: 50%;
        padding: 0 0 0 10%;
        color: white;
    }

    .text-content {
        max-width: 600px;
    }

    .hero-title {
        font-size: clamp(2.5rem, 5vw, 4rem);
        font-weight: 800;
        line-height: 1.1;
        margin: 0 0 1.5rem 0;
        background: linear-gradient(135deg, #ffffff 0%, #60a5fa 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        animation: fadeInUp 1s ease-out;
    }

    .hero-subtitle {
        font-size: clamp(1rem, 2vw, 1.25rem);
        line-height: 1.6;
        margin: 0 0 2rem 0;
        color: rgba(255, 255, 255, 0.8);
        animation: fadeInUp 1s ease-out 0.2s backwards;
    }

    .hero-actions {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
        animation: fadeInUp 1s ease-out 0.4s backwards;
    }

    .btn {
        padding: 1rem 2rem;
        font-size: 1rem;
        font-weight: 600;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .btn-primary {
        background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        color: white;
        box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
    }

    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(59, 130, 246, 0.6);
    }

    .btn-secondary {
        background: rgba(255, 255, 255, 0.1);
        color: white;
        border: 2px solid rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(10px);
    }

    .btn-secondary:hover {
        background: rgba(255, 255, 255, 0.2);
        border-color: rgba(255, 255, 255, 0.5);
        transform: translateY(-2px);
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Responsive Design */
    @media (max-width: 968px) {
        #hero-section {
            flex-direction: column;
            justify-content: center;
        }

        #earth-satellite-container {
            width: 100%;
            height: 50%;
            top: 0;
            right: 0;
            opacity: 0.3;
        }

        .hero-content {
            width: 100%;
            padding: 2rem;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .text-content {
            max-width: 500px;
        }

        .hero-actions {
            justify-content: center;
        }
    }

    @media (max-width: 640px) {
        .hero-title {
            font-size: 2rem;
        }

        .hero-subtitle {
            font-size: 1rem;
        }

        .btn {
            padding: 0.875rem 1.5rem;
            font-size: 0.9rem;
        }

        .hero-actions {
            flex-direction: column;
            width: 100%;
        }

        .btn {
            width: 100%;
        }
    }
</style>

<script>
    import * as THREE from "three";

    class OrbitControls {
        constructor(camera, domElement) {
            this.camera = camera;
            this.domElement = domElement;
            this.enableDamping = true;
            this.dampingFactor = 0.05;
            this.enableZoom = false;
            this.enablePan = false;

            this.rotateSpeed = 1.0;
            this.isRotating = false;
            this.rotateStart = new THREE.Vector2();
            this.rotateEnd = new THREE.Vector2();
            this.rotateDelta = new THREE.Vector2();

            this.spherical = new THREE.Spherical();
            this.sphericalDelta = new THREE.Spherical();

            this.target = new THREE.Vector3();
            this.offset = new THREE.Vector3();

            this.init();
        }

        init() {
            this.domElement.addEventListener(
                "mousedown",
                this.onMouseDown.bind(this),
            );
            this.domElement.addEventListener(
                "mousemove",
                this.onMouseMove.bind(this),
            );
            this.domElement.addEventListener(
                "mouseup",
                this.onMouseUp.bind(this),
            );
            this.domElement.addEventListener(
                "touchstart",
                this.onTouchStart.bind(this),
            );
            this.domElement.addEventListener(
                "touchmove",
                this.onTouchMove.bind(this),
            );
            this.domElement.addEventListener(
                "touchend",
                this.onTouchEnd.bind(this),
            );
        }

        onMouseDown(e) {
            this.isRotating = true;
            this.rotateStart.set(e.clientX, e.clientY);
        }

        onMouseMove(e) {
            if (!this.isRotating) return;
            this.rotateEnd.set(e.clientX, e.clientY);
            this.rotateDelta
                .subVectors(this.rotateEnd, this.rotateStart)
                .multiplyScalar(this.rotateSpeed);
            this.sphericalDelta.theta =
                (2 * Math.PI * this.rotateDelta.x) /
                this.domElement.clientHeight;
            this.sphericalDelta.phi =
                (2 * Math.PI * this.rotateDelta.y) /
                this.domElement.clientHeight;
            this.rotateStart.copy(this.rotateEnd);
        }

        onMouseUp() {
            this.isRotating = false;
        }

        onTouchStart(e) {
            if (e.touches.length === 1) {
                this.isRotating = true;
                this.rotateStart.set(
                    e.touches[0].clientX,
                    e.touches[0].clientY,
                );
            }
        }

        onTouchMove(e) {
            if (!this.isRotating || e.touches.length !== 1) return;
            this.rotateEnd.set(e.touches[0].clientX, e.touches[0].clientY);
            this.rotateDelta
                .subVectors(this.rotateEnd, this.rotateStart)
                .multiplyScalar(this.rotateSpeed);
            this.sphericalDelta.theta =
                (2 * Math.PI * this.rotateDelta.x) /
                this.domElement.clientHeight;
            this.sphericalDelta.phi =
                (2 * Math.PI * this.rotateDelta.y) /
                this.domElement.clientHeight;
            this.rotateStart.copy(this.rotateEnd);
        }

        onTouchEnd() {
            this.isRotating = false;
        }

        update() {
            this.offset.copy(this.camera.position).sub(this.target);
            this.spherical.setFromVector3(this.offset);

            if (this.enableDamping) {
                this.spherical.theta +=
                    this.sphericalDelta.theta * this.dampingFactor;
                this.spherical.phi +=
                    this.sphericalDelta.phi * this.dampingFactor;
                this.sphericalDelta.theta *= 1 - this.dampingFactor;
                this.sphericalDelta.phi *= 1 - this.dampingFactor;
            } else {
                this.spherical.theta += this.sphericalDelta.theta;
                this.spherical.phi += this.sphericalDelta.phi;
                this.sphericalDelta.set(0, 0, 0);
            }

            this.spherical.makeSafe();
            this.offset.setFromSpherical(this.spherical);
            this.camera.position.copy(this.target).add(this.offset);
            this.camera.lookAt(this.target);
        }
    }

    const container = document.getElementById("earth-satellite-container");
    if (!container) throw new Error("Container not found");

    // --- SETUP SCENE ---
    const scene = new THREE.Scene();
    scene.fog = new THREE.FogExp2(0x000000, 0.002);

    const camera = new THREE.PerspectiveCamera(
        75,
        container.clientWidth / container.clientHeight,
        0.1,
        1000,
    );
    camera.position.z = 5;

    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(container.clientWidth, container.clientHeight);
    container.appendChild(renderer.domElement);

    const controls = new OrbitControls(camera, renderer.domElement);

    // --- LIGHTING ---
    const ambientLight = new THREE.AmbientLight(0x333333);
    scene.add(ambientLight);

    const sunLight = new THREE.DirectionalLight(0xffffff, 1);
    sunLight.position.set(5, 3, 5);
    scene.add(sunLight);

    // --- CREATE EARTH ---
    const earthGeometry = new THREE.SphereGeometry(2, 32, 32);
    const textureLoader = new THREE.TextureLoader();

    const earthTexture = textureLoader.load("/earth.jpg");

    const earthMaterial = new THREE.MeshPhongMaterial({
        map: earthTexture,
    });
    const earth = new THREE.Mesh(earthGeometry, earthMaterial);
    scene.add(earth);

    // --- CREATE SATELLITE ---
    const orbitContainer = new THREE.Object3D();
    orbitContainer.rotation.z = 60 * (Math.PI / 180);
    earth.add(orbitContainer);

    const satellitePivot = new THREE.Object3D();
    orbitContainer.add(satellitePivot);

    const bodyTexture = textureLoader.load("/metal.jpg");
    const panelTexture = textureLoader.load("/solar.jpg");

    const satGeo = new THREE.BoxGeometry(0.08, 0.2, 0.2);
    const satMat = new THREE.MeshStandardMaterial({
        map: bodyTexture,
        roughness: 0.4,
        metalness: 0.6,
    });
    const satellite = new THREE.Mesh(satGeo, satMat);

    const panelGeo = new THREE.BoxGeometry(1, 0.01, 0.2);
    const panelMat = new THREE.MeshStandardMaterial({
        map: panelTexture,
        emissive: 0xffffff,
        emissiveMap: panelTexture,
        emissiveIntensity: 0.2,
    });

    const leftPanel = new THREE.Mesh(panelGeo, panelMat);
    leftPanel.position.set(0, 0, 0);
    leftPanel.rotation.z = Math.PI / 2;
    satellite.add(leftPanel);

    satellite.position.set(2.5, 0, 0);
    satellitePivot.add(satellite);

    // --- STARS BACKGROUND ---
    const starGeo = new THREE.BufferGeometry();
    const starCount = 1000;
    const starPos = new Float32Array(starCount * 3);
    for (let i = 0; i < starCount * 3; i++) {
        starPos[i] = (Math.random() - 0.5) * 100;
    }
    starGeo.setAttribute("position", new THREE.BufferAttribute(starPos, 3));
    const starMat = new THREE.PointsMaterial({ color: 0xffffff, size: 0.1 });
    const stars = new THREE.Points(starGeo, starMat);
    scene.add(stars);

    // --- ANIMATION LOOP ---
    function animate() {
        requestAnimationFrame(animate);
        controls.update();

        earth.rotation.y += 0.0005;
        satellitePivot.rotation.y += 0.015;
        satellite.rotation.y += 0.01;

        renderer.render(scene, camera);
    }

    animate();

    // --- HANDLE RESIZE ---
    window.addEventListener("resize", () => {
        camera.aspect = container.clientWidth / container.clientHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(container.clientWidth, container.clientHeight);
    });
</script>
